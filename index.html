<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Atacad達o Pneus</title>
<style>
/* Reset e fontes */
body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; }

/* Header */
header { background:#ffd700; padding:10px 15px; display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; position:sticky; top:0; z-index:100; }
header h1 { margin:0; font-size:20px; color:#333; }
.header-right { display:flex; gap:10px; flex-wrap:wrap; align-items:center; width:100%; max-width:600px; }
.header-right input[type="text"] { padding:8px; font-size:14px; border-radius:5px; border:1px solid #ccc; flex:1; min-width:120px; }
.header-right button { padding:8px 12px; font-size:14px; border:none; border-radius:5px; cursor:pointer; color:#fff; transition:0.2s; flex-shrink:0; }
button.search-btn { background:#00a650; }
button.store-btn { background:#3483fa; }
button.search-btn:hover, button.store-btn:hover { opacity:0.9; }

/* Filtros */
.filter-container { margin:15px 10px; display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
.filter-container select, .filter-container input[type="checkbox"] { padding:8px; font-size:14px; border-radius:5px; border:1px solid #ccc; }

/* Intro */
.intro { padding:30px 15px; text-align:center; }
.intro h2 { font-size:22px; margin-bottom:15px; }
.intro p { font-size:16px; color:#555; margin-bottom:10px; }

/* Produtos */
.products { display:flex; flex-wrap:wrap; justify-content:center; gap:15px; margin:15px 0; display:none; }
.product { background:#fff; width:calc(25% - 15px); border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); overflow:hidden; display:flex; flex-direction:column; text-align:center; transition:0.2s; }
.product:hover { transform:translateY(-5px); box-shadow:0 6px 15px rgba(0,0,0,0.2); }
.product img { width:100%; height:180px; object-fit:cover; }
.product h3 { font-size:16px; margin:10px 0 5px; padding:0 10px; color:#333; }
.product p { color:#555; margin:5px 0; font-weight:bold; }
.product button { margin:10px; padding:10px; font-size:14px; border:none; border-radius:5px; color:#333; cursor:pointer; transition:0.2s; background:#ffcc00; font-weight:bold; }
.product button:hover { background:#e6b800; }
.inmetro { margin-top:5px; color:#007700; font-weight:bold; font-size:12px; }

/* Responsividade tipo Mercado Livre */
@media screen and (max-width:1024px) { .product { width:calc(33.33% - 15px); } } /* 3 colunas tablets grandes */
@media screen and (max-width:768px)  { .product { width:calc(50% - 15px); } } /* 2 colunas tablets pequenos */
@media screen and (max-width:480px) {
    .product { width:calc(50% - 10px); } /* 2 colunas no celular */
    .filter-container { flex-direction:column; gap:8px; }
    header { justify-content:center; }
    .header-right { flex-direction:column; gap:8px; width:100%; }
    .header-right input[type="text"] { width:100%; }
}
</style>
</head>
<body>

<header>
    <h1>Atacad達o Pneus</h1>
    <div class="header-right">
        <input type="text" id="search" placeholder="Buscar produtos...">
        <button class="search-btn" onclick="searchProducts()">Pesquisar</button>
        <button class="store-btn" onclick="showStore()">Entrar na Loja</button>
    </div>
</header>

<div class="filter-container" id="filters" style="display:none;">
    <select id="tipoFilter">
        <option value="">Todos os tipos</option>
        <option value="varejo">Varejo</option>
        <option value="atacado">Atacado</option>
    </select>
    <select id="condicaoFilter">
        <option value="">Todos</option>
        <option value="novo">Novo</option>
        <option value="velho">Velho</option>
    </select>
    <label><input type="checkbox" id="inmetroFilter"> Apenas com selo Inmetro</label>
    <button onclick="applyFilters()">Aplicar Filtros</button>
</div>

<div class="intro" id="intro">
    <h2>Bem-vindo ao Atacad達o Pneus!</h2>
    <p>Confira nossos pneus de qualidade, adicione produtos e compre facilmente.</p>
    <p>Use o bot達o acima para entrar na loja ou pesquise produtos abaixo.</p>
</div>

<div class="products" id="productList"></div>

<script>
const jsonURLs = [
    "https://gabrielerroa.github.io/Atacado-dos-Pneus/produtos.JSON",
    "https://gabrielerroa.github.io/Atacado-dos-Pneus/Sport.JSON",
    "https://gabrielerroa.github.io/Atacado-dos-Pneus/PNEU.JSON"
];

let products = [];
const productList = document.getElementById('productList');

function fetchProducts(callback) {
    const fetches = jsonURLs.map(url => 
        fetch(url)
        .then(res => res.json())
        .catch(err => { console.error("Erro ao carregar:", url, err); return []; })
    );
    Promise.all(fetches).then(results => {
        products = results.flat();
        document.getElementById('filters').style.display = 'flex';
        if (callback) callback();
    });
}

function displayProducts(items) {
    productList.style.display = 'flex';
    productList.innerHTML = '';
    if(items.length === 0){
        productList.innerHTML = "<p style='width:100%; text-align:center; color:#555;'>Nenhum produto encontrado.</p>";
        return;
    }
    items.forEach(p => {
        const tipo = p.tipo ? `<p>${p.tipo.charAt(0).toUpperCase() + p.tipo.slice(1)}</p>` : '';
        const condicao = p.condicao ? `<p>${p.condicao.charAt(0).toUpperCase() + p.condicao.slice(1)}</p>` : '';
        const inmetro = p.inmetro ? '<div class="inmetro">Selo Inmetro</div>' : '';
        productList.innerHTML += `
        <div class="product">
            <img src="${p.img}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p>${p.price}</p>
            ${tipo} ${condicao} ${inmetro}
            <button onclick='viewProduct(${JSON.stringify(p)})'>Comprar</button>
        </div>`;
    });
}

function searchProducts() {
    if (products.length === 0) { fetchProducts(filterAndDisplay); } else { filterAndDisplay(); }
    function filterAndDisplay(){
        document.getElementById('intro').style.display = 'none';
        applyFilters();
    }
}

function viewProduct(product) {
    localStorage.setItem('selectedProduct', JSON.stringify(product));
    window.open('product.html', '_blank');
}

function showStore() {
    document.getElementById('intro').style.display = 'none';
    if (products.length === 0) { fetchProducts(() => displayProducts(products)); } else { displayProducts(products); }
    document.getElementById('filters').style.display = 'flex';
}

function applyFilters() {
    const tipo = document.getElementById('tipoFilter').value;
    const condicao = document.getElementById('condicaoFilter').value;
    const inmetroChecked = document.getElementById('inmetroFilter').checked;
    const query = document.getElementById('search').value.toLowerCase();

    let filtered = products.filter(p => {
        let match = true;
        if(tipo) match = match && p.tipo && p.tipo.toLowerCase() === tipo;
        if(condicao) match = match && p.condicao && p.condicao.toLowerCase() === condicao;
        if(inmetroChecked) match = match && p.inmetro === true;
        if(query) match = match && p.name.toLowerCase().includes(query);
        return match;
    });
    displayProducts(filtered);
}
</script>

</body>
</html>
