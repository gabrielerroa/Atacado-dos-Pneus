<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Atacad達o Pneus</title>
<style>
body { font-family: Arial, sans-serif; margin:0; background:#f5f5f5; }
header { background:#ffd700; padding:15px 20px; display:flex; justify-content:space-between; align-items:center; }
header h1 { margin:0; font-size:24px; color:#333; }
.header-right { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
.header-right input[type="text"] { padding:10px; font-size:16px; border-radius:5px; border:1px solid #ccc; width:200px; }
.header-right button { padding:10px 15px; font-size:16px; border:none; border-radius:5px; cursor:pointer; color:#fff; transition:0.2s; }
button.search-btn { background:#00a650; }
button.store-btn { background:#3483fa; }
button.search-btn:hover, button.store-btn:hover { opacity:0.9; }
.intro { padding:50px; text-align:center; }
.intro h2 { font-size:28px; margin-bottom:20px; }
.intro p { font-size:18px; color:#555; margin-bottom:20px; }
.products { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin:20px 0; display:none; }
.product { background:#fff; width:220px; border-radius:10px; box-shadow:0 4px 10px rgba(0,0,0,0.1); overflow:hidden; display:flex; flex-direction:column; text-align:center; transition:0.2s; }
.product:hover { transform:translateY(-5px); box-shadow:0 6px 15px rgba(0,0,0,0.2); }
.product img { width:100%; height:180px; object-fit:cover; }
.product h3 { font-size:18px; margin:10px 0 5px; padding:0 10px; color:#333; }
.product p { color:#555; margin:5px 0; font-weight:bold; }
.product button { margin:10px; padding:10px; font-size:16px; border:none; border-radius:5px; color:#333; cursor:pointer; transition:0.2s; background:#ffcc00; font-weight:bold; }
.product button:hover { background:#e6b800; }
</style>
</head>
<body>
<header>
    <h1>Atacad達o Pneus</h1>
    <div class="header-right">
        <input type="text" id="search" placeholder="Buscar produtos...">
        <button class="search-btn" onclick="searchProducts()">Pesquisar</button>
        <button class="store-btn" onclick="showStore()">Entrar na Loja</button>
    </div>
</header>
<div class="intro" id="intro">
    <h2>Bem-vindo ao Atacad達o Pneus!</h2>
    <p>Confira nossos pneus de qualidade, adicione produtos e compre facilmente.</p>
    <p>Use o bot達o acima para entrar na loja ou pesquise produtos abaixo.</p>
</div>
<div class="products" id="productList"></div>

<script>
const jsonURLs = [
    "https://gabrielerroa.github.io/Atacado-dos-Pneus/produtos.JSON",
    "https://gabrielerroa.github.io/Atacado-dos-Pneus/produtos1.JSON"
];

let products = [];
const productList = document.getElementById('productList');

function fetchProducts(callback) {
    const fetches = jsonURLs.map(url => 
        fetch(url)
        .then(res => res.json())
        .catch(err => {
            console.error("Erro ao carregar:", url, err);
            return [];
        })
    );

    Promise.all(fetches).then(results => {
        // Junta todos os produtos dos dois JSONs
        products = results.flat();
        if (callback) callback();
    });
}

function displayProducts(items) {
    productList.style.display = 'flex';
    productList.innerHTML = '';

    items.forEach(p => {
        productList.innerHTML += `
        <div class="product">
            <img src="${p.img}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p>${p.price}</p>
            <button onclick='viewProduct(${JSON.stringify(p)})'>Comprar</button>
        </div>`;
    });
}

function searchProducts() {
    if (products.length === 0) {
        fetchProducts(filterAndDisplay);
    } else {
        filterAndDisplay();
    }

    function filterAndDisplay(){
        const query = document.getElementById('search').value.toLowerCase();
        const filtered = products.filter(p => p.name.toLowerCase().includes(query));
        displayProducts(filtered);
        document.getElementById('intro').style.display = 'none';
    }
}

function viewProduct(product) {
    localStorage.setItem('selectedProduct', JSON.stringify(product));
    window.open('product.html', '_blank');
}

function showStore() {
    document.getElementById('intro').style.display = 'none';
    if (products.length === 0) {
        fetchProducts(() => displayProducts(products));
    } else {
        displayProducts(products);
    }
}
</script>

</body>
</html>
